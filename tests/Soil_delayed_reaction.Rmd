---
title: "Effects of delayed soil reaction"
author: "Stefan Paul"
date: "19. Juli 2016"
output: html_document
---

# Setup
We have two species with almost identical propoerties.
Species A is the native species, species B the invader.
Species B is more tolerant to shade. 
For simplicity we only consider light feedback as litter 
feedbacks.
Also we only consider negative microbial feedbacks.
Plant B has slightly larger negative microbial 
feedbacks on its own soil.


Start settings.
```{r}
library(psfmod)

S <- 10
L0 <- 10
    
yini <- list("BA" = 150, "BB" = 10,"S" =  S,"DA" =  200, "DB" = 10,"L0"=  L0,
             "Sa"= 1,"Dca"= 1,"Dcb" = 1)


```

First settings, soil reacts immediately to changes in plant community composition.
```{r}
pars <- list("gLC" = c(0.25, 0.25), 
          "kLC" = c(50, 40),  #
          "gNC" = c(0.25, 0.25),
          "kNC" = c(30, 30),
          "mC" = c(0.005, 0.005),
          "a" = 0.005,
          "S" = S,
          "qNC" = c(15, 15),
          "rho" = 530,
          "l_Root" = 1,
          "QNC" = c(15, 15),
          "alphaNC" = c(0, 0), # No litter nutrient feedback
          "dC" = c(0.003, 0.003),
          "cRate" = 10,
          "L0" = L0,
          "gamma_LC" = c(0.03, 0.03),
          "alpha_LC" = c(0.1, 0.1), #
          "v" = 0,
          "alpha_a" = -0.01, #
          "alpha_b" = 0,
          "beta_a" = 0,
          "beta_b" = -0.2, # 
          "sccr" = c(1,1)   ## Soil reacts immediately
)

pars <- createPar(yini, pars)

# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)

```


Now the soil reacts only gradually to changes in the plant community.
```{r}
pars <- list("gLC" = c(0.25, 0.25), 
          "kLC" = c(50, 40),  #
          "gNC" = c(0.25, 0.25),
          "kNC" = c(30, 30),
          "mC" = c(0.005, 0.005),
          "a" = 0.005,
          "S" = S,
          "qNC" = c(15, 15),
          "rho" = 530,
          "l_Root" = 1,
          "QNC" = c(15, 15),
          "alphaNC" = c(0, 0), # No litter nutrient feedback
          "dC" = c(0.003, 0.003),
          "cRate" = 10,
          "L0" = L0,
          "gamma_LC" = c(0.03, 0.03),
          "alpha_LC" = c(0.1, 0.1), #
          "v" = 0,
          "alpha_a" = -0.01, #
          "alpha_b" = 0,
          "beta_a" = 0,
          "beta_b" = -0.2, # 
          "sccr" = c(1,0.0001)   ## Soil reacts immediately
)

pars <- createPar(yini, pars)

# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)

```

