---
title: "Effects of delayed soil reaction"
author: "Stefan Paul"
date: "19. Juli 2016"
output: html_document
---

# Purpose
For various reasons it can be assumed that soil microbial communities
do not immediately react to changes in the plant communities.
However, most models do not incorporate this delay in their
simulations. 
In this document I wanted to test if a delay in the adaption
of soil biota influences the dynamics and outcomes of 
competition.
Therefore I simulated an easy hypthetic scenario contaning
almost similar species and only negative soil feedbacks.



# Setup
We have two species with almost identical propoerties.
Species A is the native species, species B the invader.
Species B is more tolerant to shade. 
For simplicity we only consider light feedback as litter 
feedbacks.
Also we only consider negative microbial feedbacks.
Plant B has slightly larger negative microbial 
feedbacks on its own soil.


Start settings.
```{r}
library(psfmod)

S <- 10
L0 <- 10
    
yini <- list("BA" = 150, "BB" = 10,"S" =  S,"DA" =  200, "DB" = 10,"L0"=  L0,
             "Sa"= 1,"Dca"= 1,"Dcb" = 1)


```

First settings, soil reacts immediately to changes in plant community composition.
```{r}
pars <- list("gLC" = c(0.25, 0.25), 
          "kLC" = c(50, 40),  #
          "gNC" = c(0.25, 0.25),
          "kNC" = c(30, 30),
          "mC" = c(0.005, 0.005),
          "a" = 0.005,
          "S" = S,
          "qNC" = c(15, 15),
          "rho" = 530,
          "l_Root" = 1,
          "QNC" = c(15, 15),
          "alphaNC" = c(0, 0), # No litter nutrient feedback
          "dC" = c(0.003, 0.003),
          "cRate" = 10,
          "L0" = L0,
          "gamma_LC" = c(0.03, 0.03),
          "alpha_LC" = c(0.1, 0.1), #
          "v" = 0,
          "alpha_a" = -0.01, #
          "alpha_b" = 0,
          "beta_a" = 0,
          "beta_b" = -0.2, # 
          "sccr" = c(1,1)   ## Soil reacts immediately
)

pars <- createPar(yini, pars)

# Model simulation
out <- psfmod(pars = pars, days = 100000)
plot(out)

```


Now the soil reacts only gradually to changes in the plant community.
```{r}
pars <- list("gLC" = c(0.25, 0.25), 
          "kLC" = c(50, 40),  #
          "gNC" = c(0.25, 0.25),
          "kNC" = c(30, 30),
          "mC" = c(0.005, 0.005),
          "a" = 0.005,
          "S" = S,
          "qNC" = c(15, 15),
          "rho" = 530,
          "l_Root" = 1,
          "QNC" = c(15, 15),
          "alphaNC" = c(0, 0), # No litter nutrient feedback
          "dC" = c(0.003, 0.003),
          "cRate" = 10,
          "L0" = L0,
          "gamma_LC" = c(0.03, 0.03),
          "alpha_LC" = c(0.1, 0.1), #
          "v" = 0,
          "alpha_a" = -0.01, #
          "alpha_b" = 0,
          "beta_a" = 0,
          "beta_b" = -0.2, # 
          "sccr" = c(1,0.0001)   ## Soil reacts gradually. Value is by intention chosen to be extreme.
)

pars <- createPar(yini, pars)

# Model simulation
out <- psfmod(pars = pars, days = 100000)
plot(out)

```


# Discussion of results
Even though the final result is not changed by the delayed reaction of the soil,
it takes much longer (and involves greater variation) until the equilibrium is 
found.
However, in real systems, which include some sort of stochasticity, these dynamics could
change the outcome of the competition if for example one species goes extinct in a phase of
very low density.
Further these results are more of theoretical nature. It can hardly be imagined that outer conditions
stay constant during the timescales simulated here.
Let me explain this with a simple example. 
If the invasion of species B is succesfull because it escapes its enemies (enemy release hypothesis)
it is easy to imagine why there is a time lag between the arrival of the species and the 
negative soil feedbacks that it has on it self. The soil must adapt or the enemy must follow
for the negative feedbacks to take effect.
However, once the soil is adapted, the adaptation of the soil in the next population peak of species 
B should be much faster, reducing the competitive strength of species B.

Also the different effects that form a negative soil-feedback might not react in the 
same time scales.








