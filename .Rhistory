"sccr" = 1   ## Soil reacts immediately
)
?psfmod
S <- 10
L0 <- 10
yini <- c(150, 10, S, 200, 10, L0,1,1,1)
S <- 10
L0 <- 10
yini <- list("BA" = 150, "BB" = 10,"S" =  S,"DA" =  200, "DB" = 10,"L0"=  L0,
"Sa"= 1,"Dca"= 1,"Dcb" = 1)
pars <- list("gLC" = c(0.25, 0.25),
"kLC" = c(50, 31),  #
"gNC" = c(0.25, 0.25),
"kNC" = c(30, 30),
"mC" = c(0.005, 0.005),
"a" = 0.005,
"S" = S,
"qNC" = c(15, 15),
"rho" = 530,
"l_Root" = 1,
"QNC" = c(15, 15),
"alphaNC" = c(0, 0), # No litter nutrient feedback
"dC" = c(0.003, 0.003),
"cRate" = 10,
"L0" = L0,
"gamma_LC" = c(0.03, 0.03),
"alpha_LC" = c(0.1, 0.1), #
"v" = 0,
"alpha_a" = -0.1, #
"alpha_b" = 0,
"beta_a" = 0,
"beta_b" = -0.3, #
"sccr" = c(1,1)   ## Soil reacts immediately
)
pars <- createPar(yini, pars)
# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)
(out)
pars <- list("gLC" = c(0.25, 0.25),
"kLC" = c(50, 31),  #
"gNC" = c(0.25, 0.25),
"kNC" = c(30, 30),
"mC" = c(0.005, 0.005),
"a" = 0.005,
"S" = S,
"qNC" = c(15, 15),
"rho" = 530,
"l_Root" = 1,
"QNC" = c(15, 15),
"alphaNC" = c(0, 0), # No litter nutrient feedback
"dC" = c(0.003, 0.003),
"cRate" = 10,
"L0" = L0,
"gamma_LC" = c(0.03, 0.03),
"alpha_LC" = c(0.1, 0.1), #
"v" = 0,
"alpha_a" = -0.01, #
"alpha_b" = 0,
"beta_a" = 0,
"beta_b" = -0.03, #
"sccr" = c(1,1)   ## Soil reacts immediately
)
pars <- createPar(yini, pars)
# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)
pars <- list("gLC" = c(0.25, 0.25),
"kLC" = c(50, 31),  #
"gNC" = c(0.25, 0.25),
"kNC" = c(30, 30),
"mC" = c(0.005, 0.005),
"a" = 0.005,
"S" = S,
"qNC" = c(15, 15),
"rho" = 530,
"l_Root" = 1,
"QNC" = c(15, 15),
"alphaNC" = c(0, 0), # No litter nutrient feedback
"dC" = c(0.003, 0.003),
"cRate" = 10,
"L0" = L0,
"gamma_LC" = c(0.03, 0.03),
"alpha_LC" = c(0.1, 0.1), #
"v" = 0,
"alpha_a" = -0.01, #
"alpha_b" = 0,
"beta_a" = 0,
"beta_b" = -0.1, #
"sccr" = c(1,1)   ## Soil reacts immediately
)
pars <- createPar(yini, pars)
# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)
pars <- list("gLC" = c(0.25, 0.25),
"kLC" = c(50, 31),  #
"gNC" = c(0.25, 0.25),
"kNC" = c(30, 30),
"mC" = c(0.005, 0.005),
"a" = 0.005,
"S" = S,
"qNC" = c(15, 15),
"rho" = 530,
"l_Root" = 1,
"QNC" = c(15, 15),
"alphaNC" = c(0, 0), # No litter nutrient feedback
"dC" = c(0.003, 0.003),
"cRate" = 10,
"L0" = L0,
"gamma_LC" = c(0.03, 0.03),
"alpha_LC" = c(0.1, 0.1), #
"v" = 0,
"alpha_a" = -0.01, #
"alpha_b" = 0,
"beta_a" = 0,
"beta_b" = -0.2, #
"sccr" = c(1,1)   ## Soil reacts immediately
)
pars <- createPar(yini, pars)
# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)
pars <- list("gLC" = c(0.25, 0.25),
"kLC" = c(50, 40),  #
"gNC" = c(0.25, 0.25),
"kNC" = c(30, 30),
"mC" = c(0.005, 0.005),
"a" = 0.005,
"S" = S,
"qNC" = c(15, 15),
"rho" = 530,
"l_Root" = 1,
"QNC" = c(15, 15),
"alphaNC" = c(0, 0), # No litter nutrient feedback
"dC" = c(0.003, 0.003),
"cRate" = 10,
"L0" = L0,
"gamma_LC" = c(0.03, 0.03),
"alpha_LC" = c(0.1, 0.1), #
"v" = 0,
"alpha_a" = -0.01, #
"alpha_b" = 0,
"beta_a" = 0,
"beta_b" = -0.2, #
"sccr" = c(1,1)   ## Soil reacts immediately
)
pars <- createPar(yini, pars)
# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)
pars <- list("gLC" = c(0.25, 0.25),
"kLC" = c(50, 40),  #
"gNC" = c(0.25, 0.25),
"kNC" = c(30, 30),
"mC" = c(0.005, 0.005),
"a" = 0.005,
"S" = S,
"qNC" = c(15, 15),
"rho" = 530,
"l_Root" = 1,
"QNC" = c(15, 15),
"alphaNC" = c(0, 0), # No litter nutrient feedback
"dC" = c(0.003, 0.003),
"cRate" = 10,
"L0" = L0,
"gamma_LC" = c(0.03, 0.03),
"alpha_LC" = c(0.1, 0.1), #
"v" = 0,
"alpha_a" = -0.01, #
"alpha_b" = 0,
"beta_a" = 0,
"beta_b" = -0.2, #
"sccr" = c(1,0.0001)   ## Soil reacts immediately
)
pars <- createPar(yini, pars)
# Model simulation
out <- psfmod(pars = pars, days = 5000)
plot(out)
out <- psfmod(pars = pars, days = 5000)
out <- psfmod(pars = pars, days = 50000)
plot(out)
out <- psfmod(pars = pars, days = 100000)
plot(out)
out[1:10,]
plot(out[,8], type = "l")
library(psfmod)
library(psfmod)
out <- psfmod(pars, 50000)
out[1:10,]
# Initial values
S <- 10 # Nutrient availability in absence of plants
L0 <- 86 # Light availability #TODO
#yini <- c(100, 10, S, 100, 10, L0,1,1,1)
# yini is composed of:
# Biomass A
# Biomass B
# S (see above)
# Litter mass A
# Litter mass B
# L0 (see above)
# S_a
# dc_a, dc_b
yini <- list("BA" = 100, "BB" = 100,"S" =  S,"DA" =  10, "DB" = 10,"L0"=  L0,
"Sa"= 0.5,"Dca"= 1,"Dcb" = 1)
# Parameter with TODO don't have fitted values yet.
# For parameter with two values:
# First others, second F. paniculata
# Parameters
pars <- list("gLC" = c(0.028, 0.018),  # Maximum growth rate under light limitation #DONE
"kLC" = c(50, 20),  # TODO    # Light availability under which 1/2 gLC is reached
"gNC" = c(0.022, 0.016), # Maximum growth rate under nutrient limitation #DONE
"kNC" = c(10, 5), # TODO # N availability under which 1/2 gNC is reached
"mC" = c(0.001, 0.0008), # TODO # per capita mortality rate
"a" = 0.05, # TODO # turnover rate of nutrient supply. Can later be determined
# because it determiens the biomass in equilibrium (see Eppinga 2011 Appendix)
"S" = S, #DONE
"qNC" = c(18, 15), #  DONE # N content of tissue
"rho" = 1200, # DONE # soil bulk density
"l_Root" = 1, #DONE # rooting depyth
"QNC" = c(18, 15), #  DONE
"alphaNC" = c(0.7, 0.7), #DONE # Nutrient litter feedback
"dC" = c(0.015, 0.008), #DONE # Litter decomposition rate
"cRate" = 10, #DONE
"L0" = L0, #TODO
"gamma_LC" = c(0.03, 0.02), #TODO # light interception coefficient
"alpha_LC" = c(0.1, 0.1), #TODO # light litter feedback coefficient
"alpha_a" = 0, #TODO?
"alpha_b" = 0, #TODO?
"beta_a" = -0.02, # partially DONE
"beta_b" = 0, #DONE
"sccr" = c(1,1) #DONE
)
# Initial values
S <- 10 # Nutrient availability in absence of plants
L0 <- 86 # Light availability #TODO
#yini <- c(100, 10, S, 100, 10, L0,1,1,1)
# yini is composed of:
# Biomass A
# Biomass B
# S (see above)
# Litter mass A
# Litter mass B
# L0 (see above)
# S_a
# dc_a, dc_b
yini <- list("BA" = 100, "BB" = 100,"S" =  S,"DA" =  10, "DB" = 10,"L0"=  L0,
"Sa"= 0.5,"Dca"= 1,"Dcb" = 1)
# Parameter with TODO don't have fitted values yet.
# For parameter with two values:
# First others, second F. paniculata
# Parameters
pars <- list("gLC" = c(0.028, 0.018),  # Maximum growth rate under light limitation #DONE
"kLC" = c(50, 20),  # TODO    # Light availability under which 1/2 gLC is reached
"gNC" = c(0.022, 0.016), # Maximum growth rate under nutrient limitation #DONE
"kNC" = c(10, 5), # TODO # N availability under which 1/2 gNC is reached
"mC" = c(0.001, 0.0008), # TODO # per capita mortality rate
"a" = 0.05, # TODO # turnover rate of nutrient supply. Can later be determined
# because it determiens the biomass in equilibrium (see Eppinga 2011 Appendix)
"S" = S, #DONE
"qNC" = c(18, 15), #  DONE # N content of tissue
"rho" = 1200, # DONE # soil bulk density
"l_Root" = 1, #DONE # rooting depyth
"QNC" = c(18, 15), #  DONE
"alphaNC" = c(0.7, 0.7), #DONE # Nutrient litter feedback
"dC" = c(0.015, 0.008), #DONE # Litter decomposition rate
"cRate" = 10, #DONE
"L0" = L0, #TODO
"gamma_LC" = c(0.03, 0.02), #TODO # light interception coefficient
"alpha_LC" = c(0.1, 0.1), #TODO # light litter feedback coefficient
"alpha_a" = 0, #TODO?
"alpha_b" = 0, #TODO?
"beta_a" = -0.02, # partially DONE
"beta_b" = 0, #DONE
"sccr" = c(1,1), "hfa" = 1
)
pars <- createPar(yini, pars)
out <- psfmod(pars, 50000)
out[1:10,]
plot(out)
tail(out)
out[30000:30010,]
yini
yini$Dca = 0.5
yini$Sa = 1
out <- psfmod(pars, 50000)
pars <- createPar(yini, pars)
out <- psfmod(pars, 50000)
# Initial values
S <- 10 # Nutrient availability in absence of plants
L0 <- 86 # Light availability #TODO
#yini <- c(100, 10, S, 100, 10, L0,1,1,1)
# yini is composed of:
# Biomass A
# Biomass B
# S (see above)
# Litter mass A
# Litter mass B
# L0 (see above)
# S_a
# dc_a, dc_b
yini <- list("BA" = 100, "BB" = 100,"S" =  S,"DA" =  10, "DB" = 10,"L0"=  L0,
"Sa"= 0.5,"Dca"= 1,"Dcb" = 1)
# Parameter with TODO don't have fitted values yet.
# For parameter with two values:
# First others, second F. paniculata
# Parameters
pars <- list("gLC" = c(0.028, 0.018),  # Maximum growth rate under light limitation #DONE
"kLC" = c(50, 20),  # TODO    # Light availability under which 1/2 gLC is reached
"gNC" = c(0.022, 0.016), # Maximum growth rate under nutrient limitation #DONE
"kNC" = c(10, 5), # TODO # N availability under which 1/2 gNC is reached
"mC" = c(0.001, 0.0008), # TODO # per capita mortality rate
"a" = 0.05, # TODO # turnover rate of nutrient supply. Can later be determined
# because it determiens the biomass in equilibrium (see Eppinga 2011 Appendix)
"S" = S, #DONE
"qNC" = c(18, 15), #  DONE # N content of tissue
"rho" = 1200, # DONE # soil bulk density
"l_Root" = 1, #DONE # rooting depyth
"QNC" = c(18, 15), #  DONE
"alphaNC" = c(0.7, 0.7), #DONE # Nutrient litter feedback
"dC" = c(0.015, 0.008), #DONE # Litter decomposition rate
"cRate" = 10, #DONE
"L0" = L0, #TODO
"gamma_LC" = c(0.03, 0.02), #TODO # light interception coefficient
"alpha_LC" = c(0.1, 0.1), #TODO # light litter feedback coefficient
"alpha_a" = 0, #TODO?
"alpha_b" = 0, #TODO?
"beta_a" = -0.02, # partially DONE
"beta_b" = 0, #DONE
"sccr" = c(1,1), "hfa" = 1
)
yini$Sa = 1
pars <- createPar(yini, pars)
out <- psfmod(pars, 50000)
out[30000:30010,]
out[1:10,]
c((1 + S_a*0.1) - dc[1], 1+(1-S_a)*0.1 - dc[2] )
dc[1]
library(psfmod)
out <- psfmod(pars, 50000)
out[1:10,]
out[30000:30010,]
library(psfmod)
out <- psfmod(pars, 50000)
out[1:10,]
out[30000:30010,]
pars
pars$yini$Dca = 0.0001
pars
# Initial values
S <- 10 # Nutrient availability in absence of plants
L0 <- 86 # Light availability #TODO
#yini <- c(100, 10, S, 100, 10, L0,1,1,1)
# yini is composed of:
# Biomass A
# Biomass B
# S (see above)
# Litter mass A
# Litter mass B
# L0 (see above)
# S_a
# dc_a, dc_b
yini <- list("BA" = 100, "BB" = 100,"S" =  S,"DA" =  10, "DB" = 10,"L0"=  L0,
"Sa"= 0.5,"Dca"= 1,"Dcb" = 1)
# Parameter with TODO don't have fitted values yet.
# For parameter with two values:
# First others, second F. paniculata
# Parameters
pars <- list("gLC" = c(0.028, 0.018),  # Maximum growth rate under light limitation #DONE
"kLC" = c(50, 20),  # TODO    # Light availability under which 1/2 gLC is reached
"gNC" = c(0.022, 0.016), # Maximum growth rate under nutrient limitation #DONE
"kNC" = c(10, 5), # TODO # N availability under which 1/2 gNC is reached
"mC" = c(0.001, 0.0008), # TODO # per capita mortality rate
"a" = 0.05, # TODO # turnover rate of nutrient supply. Can later be determined
# because it determiens the biomass in equilibrium (see Eppinga 2011 Appendix)
"S" = S, #DONE
"qNC" = c(18, 15), #  DONE # N content of tissue
"rho" = 1200, # DONE # soil bulk density
"l_Root" = 1, #DONE # rooting depyth
"QNC" = c(18, 15), #  DONE
"alphaNC" = c(0.7, 0.7), #DONE # Nutrient litter feedback
"dC" = c(0.015, 0.008), #DONE # Litter decomposition rate
"cRate" = 10, #DONE
"L0" = L0, #TODO
"gamma_LC" = c(0.03, 0.02), #TODO # light interception coefficient
"alpha_LC" = c(0.1, 0.1), #TODO # light litter feedback coefficient
"alpha_a" = 0, #TODO?
"alpha_b" = 0, #TODO?
"beta_a" = -0.02, # partially DONE
"beta_b" = 0, #DONE
"sccr" = c(1,1), "hfa" = 1
)
yini
yini$Dca = 0.0001
pars <- createPar(yini, pars)
out <- psfmod(pars, 50000)
out[30000:30010,]
out[1:10,]
# Initial values
S <- 10 # Nutrient availability in absence of plants
L0 <- 86 # Light availability #TODO
#yini <- c(100, 10, S, 100, 10, L0,1,1,1)
# yini is composed of:
# Biomass A
# Biomass B
# S (see above)
# Litter mass A
# Litter mass B
# L0 (see above)
# S_a
# dc_a, dc_b
yini <- list("BA" = 100, "BB" = 100,"S" =  S,"DA" =  10, "DB" = 10,"L0"=  L0,
"Sa"= 0.5,"Dca"= 1,"Dcb" = 1)
# Parameter with TODO don't have fitted values yet.
# For parameter with two values:
# First others, second F. paniculata
# Parameters
pars <- list("gLC" = c(0.028, 0.018),  # Maximum growth rate under light limitation #DONE
"kLC" = c(50, 20),  # TODO    # Light availability under which 1/2 gLC is reached
"gNC" = c(0.022, 0.016), # Maximum growth rate under nutrient limitation #DONE
"kNC" = c(10, 5), # TODO # N availability under which 1/2 gNC is reached
"mC" = c(0.001, 0.0008), # TODO # per capita mortality rate
"a" = 0.05, # TODO # turnover rate of nutrient supply. Can later be determined
# because it determiens the biomass in equilibrium (see Eppinga 2011 Appendix)
"S" = S, #DONE
"qNC" = c(18, 15), #  DONE # N content of tissue
"rho" = 1200, # DONE # soil bulk density
"l_Root" = 1, #DONE # rooting depyth
"QNC" = c(18, 15), #  DONE
"alphaNC" = c(0.7, 0.7), #DONE # Nutrient litter feedback
"dC" = c(0.015, 0.008), #DONE # Litter decomposition rate
"cRate" = 10, #DONE
"L0" = L0, #TODO
"gamma_LC" = c(0.03, 0.02), #TODO # light interception coefficient
"alpha_LC" = c(0.1, 0.1), #TODO # light litter feedback coefficient
"alpha_a" = 0, #TODO?
"alpha_b" = 0, #TODO?
"beta_a" = -0.02, # partially DONE
"beta_b" = 0, #DONE
"sccr" = c(0.0001,1), "hfa" = 1
)
pars <- createPar(yini, pars)
out <- psfmod(pars, 50000)
out[30000:30010,]
out[1:10,]
plot(out)
library(psfmod)
out <- psfmod(pars, 50000)
out[1:10,]
out[30000:30010,]
library(psfmod)
out <- psfmod(pars, 50000)
out[1:10,]
out[30000:30010,]
library(psfmod)
out <- psfmod(pars, 50000)
out[30000:30010,]
out[1:10,]
plot(out)
library(psfmod)
plot(x = NULL, y = NULL)
plot(1, type="n", axes=F, xlab="", ylab="")
plot(1, type="n", axes=T, xlab="", ylab="")
theta = 0.98
Pmax = 27.5
alpha = 0.036
#I = irradiance
Pn <- function(I){
1/(2*theta)*(alpha*I + Pmax - ((a*I + Pmax)^2 - 4*theta*alpha*I*Pmax)^0.5)
}
Pn <- function(I){
1/(2*theta)*(alpha*I + Pmax - ((alpha*I + Pmax)^2 - 4*theta*alpha*I*Pmax)^0.5)
}
Pn(100)
curve(Pn(x))
?curve
curve(Pn(x), from  = 0, to = 5000)
Iseq = seq(0,3000, len = 100000)
for(i in Iseq) Pvec[i] <- Pn(Iseq[i])
Pvec <- numeric()
Pvec <- numeric(100000)
for(i in Iseq) Pvec[i] <- Pn(Iseq[i])
plot(pvec, type = "l")
plot(Pvec, type = "l")
Pvec[1:100]
Pvec[10000]
Iseq[10000]
Pn(Iseq[100000])
Pvec <- numeric(100000)
Iseq = seq(0,3000, len = 100000)
for(i in 1:100000) Pvec[i] <- Pn(Iseq[i])
plot(Pvec, type = "l")
max(Pvec)
v <- 0.5*max(Pvec)
v
which(Pvec == v)
PvecR <- round(Pvec, 2)
which(PvecR == v)
v
v <- round(0.5*max(Pvec),2)
which(PvecR == v)
Iseq[12898]
v <- round(0.5*max(Pvec),3)
which(Pvec == v)
Iseq[12894]
387 *1000
387/1000
(387/1000)*60*60*24
(387/1e-6)*60*60*24
(387*1e-6)*60*60*24
(387/1e6)*60*60*24
(200/1e6)*60*60*24
